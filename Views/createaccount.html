<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>All Cards</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"> 
  <link rel="stylesheet" href="styles.css">
   <script src="scripts.js"></script>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="index.html">Pokémon TCG Collection</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button> 
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="http://localhost:3000/cards/landing.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="http://localhost:3000/cards/createaccount.html">Create Account/Sign in</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="http://localhost:3000/cards/collections.html">Collections</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="http://localhost:3000/cards/allcards.html">All Cards</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="expansionsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Expansions
            </a>
            <ul class="dropdown-menu" aria-labelledby="expansionsDropdown">
              <li><a class="dropdown-item" href="expansions.html#base">Base</a></li>
              <li><a class="dropdown-item" href="expansions.html#Jungle">Jungle</a></li>
              <li><a class="dropdown-item" href="expansions.html#Fossil">Fossil</a></li>
              <li><a class="dropdown-item" href="expansions.html#BaseSet2">Base Set 2</a></li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="discussion.html">Discussion</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="howtoplay.html" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              How to play
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
              <li><a class="dropdown-item" href="howtoplay.html#objective">Objective</a></li>
              <li><a class="dropdown-item" href="howtoplay.html#setup">Setup</a></li>
              <li><a class="dropdown-item" href="howtoplay.html#gameplay">Gameplay</a></li>
              <li><a class="dropdown-item" href="howtoplay.html#winning">Winning the Game</a></li>
              <li><a class="dropdown-item" href="howtoplay.html#conditions">Special Conditions</a></li>
              <li><a class="dropdown-item" href="howtoplay.html#rules">Rules and Card Effects</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <form id="createAccountForm">
  <p id="loginStatus" style="display: none;"></p>


  <div id="loggedInStatus" class="alert alert-success" style="display: none;"></div>
  <button id="logoutButton" class="btn btn-danger" style="display: none;">Logout</button>
<div id="logoutMessage" class="alert alert-info" style="display: none;"></div>
 
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <form id="signInForm" action="/login" method="POST">
          <div class="mb-3">
            <label for="exampleInputEmail1" class="form-label">Email address</label>
            <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="email">
            <div id="emailHelp" class="form-text">We'll never share your data with anyone else.</div>
          </div>
          <div class="mb-3">
            <label for="exampleInputPassword1" class="form-label">Password</label>
            <input type="password" class="form-control" id="exampleInputPassword1" name="password">
          </div>
          <button type="submit" class="btn btn-primary">Sign In</button>
        </form>
      </div>

      <div class="col-md-6">
        <form id="createAccountForm" action="/register" method="POST">
          <div class="mb-3">
            <label for="exampleInputName" class="form-label">Name</label>
            <input type="text" class="form-control" id="exampleInputName" aria-describedby="nameHelp" name="name">
            <div id="nameHelp" class="form-text">Enter your full name.</div>
          </div>
          <div class="mb-3">
            <label for="exampleInputEmail2" class="form-label">Email address</label>
            <input type="email" class="form-control" id="exampleInputEmail2" aria-describedby="emailHelp" name="email">
            <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>
          </div>
          <div class="mb-3">
            <label for="exampleInputPassword2" class="form-label">Password</label>
            <input type="password" class="form-control" id="exampleInputPassword2" name="password">
          </div>
          <div class="mb-3">
            <label for="exampleInputConfirmPassword" class="form-label">Confirm Password</label>
            <input type="password" class="form-control" id="exampleInputConfirmPassword">
          </div>
          <button type="submit" class="btn btn-primary">Create Account</button>
        </form>
      </div>
    </div>
  </div>

  <div class="row mt-3">
    <div class="col text-center">
      <p id="loginStatus" style="display: none;"></p>
      <form id="logoutForm" action="/logout" method="GET" style="display: none;">
        <button type="submit" class="btn btn-danger">Logout</button>
      </form>
    </div>
  </div>
</div>

  <!-- Back to top button -->
  <button onclick="topFunction()" id="back-to-top-btn" title="Go to top">Top</button>
  <!-- Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Custom JavaScript -->
  <script>
    // Get the button
    var mybutton = document.getElementById("back-to-top-btn");
    // When the user scrolls down 20px from the top of the document, show the button
    window.onscroll = function() {scrollFunction()};
    function scrollFunction() {
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
        mybutton.style.display = "block";
      } else {
        mybutton.style.display = "none";
      }
    }
    // When the user clicks on the button, scroll to the top of the document
    function topFunction() {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    }

// Some of this code is correct and works well, it lets you create a new account which then gets posted and stored in the sql database, redirects you to the collection page with the idea that you needed to be logged in to access this page, however anyone can just see it.

    document.getElementById('createAccountForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent the form from submitting through the browser
    
        var formData = {
            name: document.getElementById('exampleInputName').value,
            email: document.getElementById('exampleInputEmail2').value,
            password: document.getElementById('exampleInputPassword2').value
        };
    
        fetch('/register', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // Display the success message
                document.getElementById('loginStatus').innerText = data.message;
                document.getElementById('loginStatus').style.display = 'block';
            } else {
                // Handle failures
                document.getElementById('loginStatus').innerText = 'Failed to create account: ' + data.message;
                document.getElementById('loginStatus').style.display = 'block';
            }
        })
        .catch(error => {
            console.error('Error:', error);
        });
    });

    document.getElementById('signInForm').addEventListener('submit', function(event) {
    
        var loginData = {
            email: document.getElementById('exampleInputEmail1').value,
            password: document.getElementById('exampleInputPassword1').value
        };
    
        fetch('/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(loginData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // Show signed in message
                document.getElementById('loginStatus').innerText = 'Signed in successfully!';
                document.getElementById('loginStatus').style.display = 'block';
            } else {
                // Handle login failure
                document.getElementById('loginStatus').innerText = data.message;
                document.getElementById('loginStatus').style.display = 'block';
            }
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('loginStatus').innerText = 'Login error: ' + error.message;
            document.getElementById('loginStatus').style.display = 'block';
        });
    });

  </script>

  <!-- Footer -->
  <footer class="footer mt-5 py-3 bg-dark text-white">
    <div class="container">
      <span>&copy; 2024 Pokémon TCG Collection</span>
    </div>
  </footer>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- title -->
  <title>All Cards</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"> 
  <!-- custom stylesheet -->
  <link rel="stylesheet" href="styles.css">
   <!-- custom script -->
  <script src="scripts.js"></script>
</head>
<body>
  <!-- navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="index.html">Pokémon TCG Collection</a>
      <!-- navbar toggle button -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button> 
      <!-- navbar collapse -->
      <div class="collapse navbar-collapse" id="navbarNav">
        <!-- navbar items -->
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="http://localhost:3000/cards/landing.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="http://localhost:3000/cards/createaccount.html">Create Account/Sign in</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="http://localhost:3000/cards/collections.html">Collections</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="http://localhost:3000/cards/allcards.html">All Cards</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="expansionsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Expansions
            </a>
            <!-- dropdown menu -->
            <ul class="dropdown-menu" aria-labelledby="expansionsDropdown">
              <li><a class="dropdown-item" href="expansions.html#base">Base</a></li>
              <li><a class="dropdown-item" href="expansions.html#Jungle">Jungle</a></li>
              <li><a class="dropdown-item" href="expansions.html#Fossil">Fossil</a></li>
              <li><a class="dropdown-item" href="expansions.html#BaseSet2">Base Set 2</a></li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="discussion.html">Discussion</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="howtoplay.html" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              How to play
            </a>
            <!-- dropdown menu -->
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
              <li><a class="dropdown-item" href="howtoplay.html#objective">Objective</a></li>
              <li><a class="dropdown-item" href="howtoplay.html#setup">Setup</a></li>
              <li><a class="dropdown-item" href="howtoplay.html#gameplay">Gameplay</a></li>
              <li><a class="dropdown-item" href="howtoplay.html#winning">Winning the Game</a></li>
              <li><a class="dropdown-item" href="howtoplay.html#conditions">Special Conditions</a></li>
              <li><a class="dropdown-item" href="howtoplay.html#rules">Rules and Card Effects</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Create Account Form -->
  <form id="createAccountForm">
    <!-- Login status message -->
    <p id="loginStatus" style="display: none;"></p>
    <!-- Logged in status message -->
    <div id="loggedInStatus" class="alert alert-success" style="display: none;"></div>
    <!-- Logout button -->
    <button id="logoutButton" class="btn btn-danger" style="display: none;">Logout</button>
    <div id="logoutMessage" class="alert alert-info" style="display: none;"></div>
   
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <!-- Sign In Form -->
          <form id="signInForm" action="/login" method="POST">
            <div class="mb-3">
              <label for="exampleInputEmail1" class="form-label">Email address</label>
              <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" name="email">
              <div id="emailHelp" class="form-text">We'll never share your data with anyone else.</div>
            </div>
            <div class="mb-3">
              <label for="exampleInputPassword1" class="form-label">Password</label>
              <input type="password" class="form-control" id="exampleInputPassword1" name="password">
            </div>
            <!-- Sign In button -->
            <button type="submit" class="btn btn-primary">Sign In</button>
          </form>
        </div>
  
        <div class="col-md-6">
          <!-- Create Account Form -->
          <form id="createAccountForm" action="/register" method="POST">
            <div class="mb-3">
              <label for="exampleInputName" class="form-label">Name</label>
              <input type="text" class="form-control" id="exampleInputName" aria-describedby="nameHelp" name="name">
              <div id="nameHelp" class="form-text">Enter your full name.</div>
            </div>
            <div class="mb-3">
              <label for="exampleInputEmail2" class="form-label">Email address</label>
              <input type="email" class="form-control" id="exampleInputEmail2" aria-describedby="emailHelp" name="email">
              <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>
            </div>
            <div class="mb-3">
              <label for="exampleInputPassword2" class="form-label">Password</label>
              <input type="password" class="form-control" id="exampleInputPassword2" name="password">
            </div>
            <div class="mb-3">
              <label for="exampleInputConfirmPassword" class="form-label">Confirm Password</label>
              <input type="password" class="form-control" id="exampleInputConfirmPassword">
            </div>
            <!-- Create Account button -->
            <button type="submit" class="btn btn-primary">Create Account</button>
          </form>
        </div>
      </div>
    </div>
  
    <!-- Logout section -->
    <div class="row mt-3">
      <div class="col text-center">
        <!-- Login status message -->
        <p id="loginStatus" style="display: none;"></p>
        <!-- Logout form -->
        <form id="logoutForm" action="/logout" method="GET" style="display: none;">
          <!-- Logout button -->
          <button type="submit" class="btn btn-danger">Logout</button>
        </form>
      </div>
    </div>
  </form>

  <!-- Back to top button -->
  <button onclick="topFunction()" id="back-to-top-btn" title="Go to top">Top</button>
  <!-- Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Custom JavaScript -->
  <script>
    // Back to top button functionality
    var mybutton = document.getElementById("back-to-top-btn");
    window.onscroll = function() {scrollFunction()};
    function scrollFunction() {
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
        mybutton.style.display = "block";
      } else {
        mybutton.style.display = "none";
      }
    }
    // Scroll to top function
    function topFunction() {
      document.body.scrollTop = 0;
      document.documentElement.scrollTop = 0;
    }

// Some of this code is correct and works well, it lets you create a new account which then gets posted and stored in the sql database, redirects you to the collection page with the idea that you needed to be logged in to access this page, however anyone can just see it.


    // Create Account Form submission
    document.getElementById('createAccountForm').addEventListener('submit', function(event) {

    
        var formData = {
            name: document.getElementById('exampleInputName').value,
            email: document.getElementById('exampleInputEmail2').value,
            password: document.getElementById('exampleInputPassword2').value
        };
    
        fetch('/register', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // Display the success message
                document.getElementById('loginStatus').innerText = data.message;
                document.getElementById('loginStatus').style.display = 'block';
            } else {
                // Handle failures
                document.getElementById('loginStatus').innerText = 'Failed to create account: ' + data.message;
                document.getElementById('loginStatus').style.display = 'block';
            }
        })
        .catch(error => {
            console.error('Error:', error);
        });
    });

    // Sign In Form submission
    document.getElementById('signInForm').addEventListener('submit', function(event) {
    
        var loginData = {
            email: document.getElementById('exampleInputEmail1').value,
            password: document.getElementById('exampleInputPassword1').value
        };
    
        fetch('/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(loginData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // Show signed in message
                document.getElementById('loginStatus').innerText = 'Signed in successfully!';
                document.getElementById('loginStatus').style.display = 'block';
            } else {
                // Handle login failure
                document.getElementById('loginStatus').innerText = data.message;
                document.getElementById('loginStatus').style.display = 'block';
            }
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('loginStatus').innerText = 'Login error: ' + error.message;
            document.getElementById('loginStatus').style.display = 'block';
        });
    });

  </script>

  <!-- Footer -->
  <footer class="footer mt-5 py-3 bg-dark text-white">
    <div class="container">
      <span>&copy; 2024 Pokémon TCG Collection</span>
    </div>
  </footer>
</body>
</html>
